{"status":"safe","types":{"84":{"25":{"ann":"a -> a","ident":"act","row":84,"col":25},"31":{"ann":"{v : (Internal.Matrix.Matrix a) | v == m}","ident":"m","row":84,"col":31},"36":{"ann":"{v : (Data.Vector.Storable.Vector a) | v == inp}","ident":"lq_anf$##7205759403792827604","row":84,"col":36},"12":{"ann":"(Data.Vector.Storable.Vector a)","ident":"inp","row":84,"col":12},"16":{"ann":"(Internal.Matrix.Matrix a)","ident":"m","row":84,"col":16},"20":{"ann":"(Data.Vector.Storable.Vector a) -> (Data.Vector.Storable.Vector a)","ident":"lq_anf$##7205759403792827605","row":84,"col":20},"9":{"ann":"(Data.Vector.Storable.Vector a) -> (Internal.Matrix.Matrix a) -> (Data.Vector.Storable.Vector a)","ident":"f","row":84,"col":9}},"51":{"28":{"ann":"{VV : forall a . (Data.Vector.Vector a) -> [a] | VV == toList}","ident":"_","row":51,"col":28},"22":{"ann":"[(Internal.Matrix.Matrix a)] -> (Data.Binary.Put.PutM ())","ident":"lq_anf$##7205759403792827526","row":51,"col":22},"3":{"ann":"forall a .\n(Internal.Matrix.Element<[]> a, Data.Binary.Class.Binary<[]> a) =>\n(Neuro.Network a) -> (Data.Binary.Put.PutM ())","ident":"$cput","row":51,"col":3}},"73":{"31":{"ann":"{v : GHC.Types.Int | v == m}","ident":"lq_anf$##7205759403792827578","row":73,"col":31},"19":{"ann":"a (Internal.Matrix.Matrix b)","ident":"_","row":73,"col":19},"29":{"ann":"{v : GHC.Types.Int | v == n}","ident":"lq_anf$##7205759403792827577","row":73,"col":29},"12":{"ann":"(Internal.Matrix.Matrix a)","ident":"mat","row":73,"col":12},"33":{"ann":"(System.Random.MWC.Gen (Control.Monad.Primitive.PrimState a))","ident":"ds_d8IR","row":73,"col":33}},"124":{"51":{"ann":"{v : Data.ByteString.Lazy.Internal.ByteString | v == encode net}","ident":"lq_anf$##7205759403792827723","row":124,"col":51},"13":{"ann":"[GHC.Types.Char]","ident":"fp","row":124,"col":13},"22":{"ann":"Data.ByteString.Lazy.Internal.ByteString -> (GHC.Types.IO ())","ident":"lq_anf$##7205759403792827721","row":124,"col":22},"35":{"ann":"{v : [GHC.Types.Char] | len v >= 0\n                        && v == fp}","ident":"fp","row":124,"col":35},"1":{"ann":"forall a .\n(Foreign.Storable.Storable<[]> a, Internal.Matrix.Element<[]> a, Data.Binary.Class.Binary<[]> a) =>\n[GHC.Types.Char] -> (Neuro.Network a) -> (GHC.Types.IO ())","ident":"Neuro.saveNetwork","row":124,"col":1},"40":{"ann":"Data.ByteString.Lazy.Internal.ByteString -> Data.ByteString.Lazy.Internal.ByteString","ident":"Codec.Compression.Zlib.compress","row":124,"col":40},"16":{"ann":"(Neuro.Network a)","ident":"net","row":124,"col":16},"58":{"ann":"{v : (Neuro.Network a) | v == net}","ident":"net","row":124,"col":58}},"75":{"61":{"ann":"{v : GHC.Types.Int | v == n}","ident":"n","row":75,"col":61},"19":{"ann":"GHC.Types.Int","ident":"n","row":75,"col":19},"44":{"ann":"a (Data.Vector.Storable.Vector b)","ident":"lq_anf$##7205759403792827570","row":75,"col":44},"35":{"ann":"{v : GHC.Types.Int | v == m}","ident":"m","row":75,"col":35},"23":{"ann":"(System.Random.MWC.Gen (Control.Monad.Primitive.PrimState a))","ident":"g","row":75,"col":23},"58":{"ann":"{v : (System.Random.MWC.Gen (Control.Monad.Primitive.PrimState a)) | v == g}","ident":"g","row":75,"col":58},"27":{"ann":"(Data.Vector.Storable.Vector a) -> (Internal.Matrix.Matrix a)","ident":"lq_anf$##7205759403792827568","row":75,"col":27},"63":{"ann":"{v : GHC.Types.Int | v == m}","ident":"m","row":75,"col":63},"21":{"ann":"GHC.Types.Int","ident":"m","row":75,"col":21},"60":{"ann":"{v : GHC.Types.Int | v == n * m\n                     && v == * n m}","ident":"lq_anf$##7205759403792827569","row":75,"col":60},"9":{"ann":"forall a b .\n(Foreign.Storable.Storable<[]> b, Control.Monad.Primitive.PrimMonad<[]> a, System.Random.MWC.Variate<[]> b) =>\nGHC.Types.Int -> GHC.Types.Int -> (System.Random.MWC.Gen (Control.Monad.Primitive.PrimState a)) -> a (Internal.Matrix.Matrix b)","ident":"randomMat","row":75,"col":9}},"50":{"10":{"ann":"forall a .\n(Internal.Matrix.Element<[]> a, Data.Binary.Class.Binary<[]> a) =>\n(Data.Binary.Class.Binary (Neuro.Network a))","ident":"Neuro.$fBinaryNetwork","row":50,"col":10}},"101":{"43":{"ann":"{v : (Data.Vector.Vector (Internal.Matrix.Matrix a)) | 0 <= vlen v}","ident":"lq_anf$##7205759403792827678","row":101,"col":43},"19":{"ann":"(Data.Vector.Vector (Internal.Matrix.Matrix a))","ident":"lq_anf$##7205759403792827681","row":101,"col":19},"35":{"ann":"{VV : a | VV == alpha}","ident":"alpha","row":101,"col":35},"26":{"ann":"(Internal.Matrix.Matrix a) -> (Internal.Matrix.Matrix a)","ident":"lq_anf$##7205759403792827680","row":101,"col":26},"33":{"ann":"{VV : a | VV == (-alpha)\n          && VV == negate alpha}","ident":"lq_anf$##7205759403792827679","row":101,"col":33}},"118":{"15":{"ann":"a","ident":"lq_anf$##7205759403792827712","row":118,"col":15},"22":{"ann":"a","ident":"lq_anf$##7205759403792827714","row":118,"col":22},"19":{"ann":"{VV : a | VV == tanh x\n          && VV == s}","ident":"s","row":118,"col":19}},"91":{"22":{"ann":"a -> a","ident":"act'","row":91,"col":22},"30":{"ann":"(Data.Vector.Storable.Vector a)","ident":"expected","row":91,"col":30},"71":{"ann":"{v : (Data.Vector.Vector (Data.Vector.Storable.Vector a)) | v == init os}","ident":"lq_anf$##7205759403792827666","row":91,"col":71},"67":{"ann":"{v : (Data.Vector.Vector (Data.Vector.Storable.Vector a)) | 0 <= vlen v}","ident":"lq_anf$##7205759403792827663","row":91,"col":67},"1":{"ann":"forall a .\n(GHC.Float.Floating<[]> (Data.Vector.Storable.Vector a), GHC.Float.Floating<[]> a, Internal.Numeric.Numeric<[]> a, Internal.Numeric.Container<[]> Data.Vector.Storable.Vector a, GHC.Num.Num<[]> (Data.Vector.Storable.Vector a)) =>\n(Neuro.Network a) -> (a -> a) -> (Data.Vector.Vector (Data.Vector.Storable.Vector a)) -> (Data.Vector.Storable.Vector a) -> (Data.Vector.Vector (Internal.Matrix.Matrix a))","ident":"Neuro.deltas","row":91,"col":1},"52":{"ann":"(Data.Vector.Storable.Vector a) -> (Data.Vector.Storable.Vector a) -> (Internal.Matrix.Matrix a)","ident":"lq_anf$##7205759403792827664","row":91,"col":52},"58":{"ann":"(Data.Vector.Vector (Data.Vector.Storable.Vector a))","ident":"lq_anf$##7205759403792827665","row":91,"col":58},"27":{"ann":"(Data.Vector.Vector (Data.Vector.Storable.Vector a))","ident":"os","row":91,"col":27},"41":{"ann":"{VV : forall a b c .\n      (a -> b -> c) -> (Data.Vector.Vector a) -> (Data.Vector.Vector b) -> (Data.Vector.Vector c) | VV == zipWith}","ident":"Data.Vector.zipWith","row":91,"col":41},"80":{"ann":"{v : (Data.Vector.Vector (Data.Vector.Storable.Vector a)) | 0 <= vlen v\n                                                            && v == os}","ident":"os","row":91,"col":80}},"88":{"25":{"ann":"a -> a","ident":"act","row":88,"col":25},"31":{"ann":"{v : (Internal.Matrix.Matrix a) | v == m}","ident":"m","row":88,"col":31},"36":{"ann":"{v : (Data.Vector.Storable.Vector a) | v == inp}","ident":"lq_anf$##7205759403792827629","row":88,"col":36},"12":{"ann":"(Data.Vector.Storable.Vector a)","ident":"inp","row":88,"col":12},"16":{"ann":"(Internal.Matrix.Matrix a)","ident":"m","row":88,"col":16},"20":{"ann":"(Data.Vector.Storable.Vector a) -> (Data.Vector.Storable.Vector a)","ident":"lq_anf$##7205759403792827630","row":88,"col":20},"9":{"ann":"(Data.Vector.Storable.Vector a) -> (Internal.Matrix.Matrix a) -> (Data.Vector.Storable.Vector a)","ident":"f","row":88,"col":9}},"83":{"61":{"ann":"(Data.Vector.Storable.Vector a)","ident":"lq_anf$##7205759403792827611","row":83,"col":61},"22":{"ann":"a -> a","ident":"act","row":83,"col":22},"44":{"ann":"(Data.Vector.Storable.Vector a) -> (Internal.Matrix.Matrix a) -> (Data.Vector.Storable.Vector a)","ident":"f","row":83,"col":44},"53":{"ann":"{v : [(Data.Vector.Storable.Vector a)] | head v == input\n                                         && lqdc##$select v == input}","ident":"lq_anf$##7205759403792827614","row":83,"col":53},"1":{"ann":"forall a .\n(GHC.Float.Floating<[]> (Data.Vector.Storable.Vector a), Internal.Numeric.Numeric<[]> a, Foreign.Storable.Storable<[]> a, GHC.Num.Num<[]> (Data.Vector.Storable.Vector a)) =>\n(Neuro.Network a) -> (a -> a) -> (Data.Vector.Storable.Vector a) -> (Data.Vector.Storable.Vector a)","ident":"Neuro.output","row":83,"col":1},"26":{"ann":"(Data.Vector.Storable.Vector a)","ident":"input","row":83,"col":26},"34":{"ann":"(Data.Vector.Vector (Internal.Matrix.Matrix a))","ident":"lq_anf$##7205759403792827616","row":83,"col":34},"46":{"ann":"(Data.Vector.Storable.Vector a)","ident":"lq_anf$##7205759403792827615","row":83,"col":46},"54":{"ann":"{v : (Data.Vector.Storable.Vector a) | v == input}","ident":"input","row":83,"col":54}},"113":{"114":{"ann":"{v : [((Data.Vector.Storable.Vector a), (Data.Vector.Storable.Vector a))] | len v >= 0\n                                                                            && v == samples}","ident":"samples","row":113,"col":114},"51":{"ann":"GHC.Types.Double","ident":"err","row":113,"col":51},"15":{"ann":"(Neuro.Network a)","ident":"net","row":113,"col":15},"96":{"ann":"a -> a","ident":"act","row":113,"col":96},"106":{"ann":"{v : (Data.Vector.Storable.Vector a) | v == out}","ident":"out","row":113,"col":106},"112":{"ann":"{v : GHC.Types.Double | v == 0.0\n                        && v == D# 0.0}","ident":"lq_anf$##7205759403792827626","row":113,"col":112},"75":{"ann":"GHC.Types.Double","ident":"lq_anf$##7205759403792827624","row":113,"col":75},"49":{"ann":"((Data.Vector.Storable.Vector a), (Data.Vector.Storable.Vector a))","ident":"lq_anf$##7205759403792827620","row":113,"col":49},"85":{"ann":"{v : (Data.Vector.Storable.Vector a) | v == output net act inp}","ident":"lq_anf$##7205759403792827622","row":113,"col":85},"19":{"ann":"[((Data.Vector.Storable.Vector a), (Data.Vector.Storable.Vector a))]","ident":"samples","row":113,"col":19},"29":{"ann":"GHC.Types.Double -> (Internal.Numeric.RealOf a)","ident":"lq_anf$##7205759403792827619","row":113,"col":29},"100":{"ann":"{v : (Data.Vector.Storable.Vector a) | v == inp}","ident":"inp","row":113,"col":100},"1":{"ann":"forall a .\n(GHC.Float.Floating<[]> (Data.Vector.Storable.Vector a), GHC.Float.Floating<[]> a, GHC.Real.Fractional<[]> (Internal.Numeric.RealOf a), Internal.Util.Normed<[]> (Data.Vector.Storable.Vector a), Internal.Numeric.Numeric<[]> a) =>\n(a -> a) -> (Neuro.Network a) -> [((Data.Vector.Storable.Vector a), (Data.Vector.Storable.Vector a))] -> (Internal.Numeric.RealOf a)","ident":"Neuro.quadError","row":113,"col":1},"69":{"ann":"{v : GHC.Types.Double | v == err}","ident":"err","row":113,"col":69},"11":{"ann":"a -> a","ident":"act","row":113,"col":11},"92":{"ann":"{v : (Neuro.Network a) | v == net}","ident":"net","row":113,"col":92},"42":{"ann":"GHC.Types.Double","ident":"lq_anf$##7205759403792827627","row":113,"col":42},"76":{"ann":"(Data.Vector.Storable.Vector a) -> GHC.Types.Double","ident":"lq_anf$##7205759403792827621","row":113,"col":76}},"74":{"14":{"ann":"(System.Random.MWC.Gen (Control.Monad.Primitive.PrimState a))","ident":"ds_d8IR","row":74,"col":14},"22":{"ann":"{v : (Data.Vector.Vector (Internal.Matrix.Matrix a)) | 0 <= vlen v\n                                                       && v == ms}","ident":"ms","row":74,"col":22},"35":{"ann":"{v : (Internal.Matrix.Matrix a) | v == mat}","ident":"lq_anf$##7205759403792827579","row":74,"col":35},"18":{"ann":"{v : [(GHC.Types.Int, GHC.Types.Int)] | len v >= 0\n                                        && v == ds}","ident":"ds","row":74,"col":18},"11":{"ann":"(System.Random.MWC.Gen (Control.Monad.Primitive.PrimState a)) -> [(GHC.Types.Int, GHC.Types.Int)] -> (Data.Vector.Vector (Internal.Matrix.Matrix b)) -> a (Data.Vector.Vector (Internal.Matrix.Matrix b))","ident":"go","row":74,"col":11},"21":{"ann":"(Data.Vector.Vector (Internal.Matrix.Matrix a))","ident":"lq_anf$##7205759403792827580","row":74,"col":21}},"71":{"31":{"ann":"{v : (GHC.Base.Monad a) | v == $p1PrimMonad\n                          && v == $dMonad_a7JV}","ident":"$dMonad_a7JV","row":71,"col":31},"18":{"ann":"(Data.Vector.Vector (Internal.Matrix.Matrix a))","ident":"ms","row":71,"col":18},"38":{"ann":"{v : (Data.Vector.Vector (Internal.Matrix.Matrix a)) | 0 <= vlen v\n                                                       && v == ms}","ident":"lq_anf$##7205759403792827572","row":71,"col":38},"9":{"ann":"(System.Random.MWC.Gen (Control.Monad.Primitive.PrimState a)) -> [(GHC.Types.Int, GHC.Types.Int)] -> (Data.Vector.Vector (Internal.Matrix.Matrix b)) -> a (Data.Vector.Vector (Internal.Matrix.Matrix b))","ident":"go","row":71,"col":9}},"68":{"15":{"ann":"GHC.Types.Int","ident":"nInputs","row":68,"col":15},"31":{"ann":"GHC.Types.Int","ident":"nOutputs","row":68,"col":31},"1":{"ann":"forall a .\n(System.Random.MWC.Variate<[]> a, Foreign.Storable.Storable<[]> a) =>\nGHC.Types.Int -> [GHC.Types.Int] -> GHC.Types.Int -> (GHC.Types.IO (Neuro.Network a))","ident":"Neuro.createNetwork","row":68,"col":1},"23":{"ann":"[GHC.Types.Int]","ident":"hiddens","row":68,"col":23}},"100":{"31":{"ann":"{v : (Data.Vector.Vector (Data.Vector.Storable.Vector a)) | v == outputs n act input\n                                                            && 0 <= vlen v}","ident":"lq_anf$##7205759403792827676","row":100,"col":31},"17":{"ann":"(Data.Vector.Vector (Internal.Matrix.Matrix a))","ident":"lq_anf$##7205759403792827677","row":100,"col":17},"26":{"ann":"a -> a","ident":"act'","row":100,"col":26},"34":{"ann":"{v : (Data.Vector.Storable.Vector a) | v == expectedOutput}","ident":"expectedOutput","row":100,"col":34},"24":{"ann":"{v : (Neuro.Network a) | v == n}","ident":"n","row":100,"col":24}},"1":{"1":{"ann":"GHC.Types.Module","ident":"Neuro.$trModule","row":1,"col":1}},"62":{"51":{"ann":"(Neuro.Network a) -> GHC.Types.Int -> (Neuro.Network a)","ident":"go","row":62,"col":51},"15":{"ann":"a","ident":"learningRate","row":62,"col":15},"37":{"ann":"(Neuro.Network a)","ident":"net","row":62,"col":37},"28":{"ann":"a -> a","ident":"act","row":62,"col":28},"12":{"ann":"GHC.Types.Int -> (Neuro.Network a) -> [((Data.Vector.Storable.Vector a), (Data.Vector.Storable.Vector a))] -> GHC.Types.Bool","ident":"pr","row":62,"col":12},"1":{"ann":"forall a .\n(GHC.Float.Floating<[]> (Data.Vector.Storable.Vector a), GHC.Float.Floating<[]> a, Internal.Numeric.Numeric<[]> a, GHC.Num.Num<[]> (Data.Vector.Storable.Vector a), Internal.Numeric.Container<[]> Data.Vector.Storable.Vector a) =>\n(GHC.Types.Int -> (Neuro.Network a) -> [((Data.Vector.Storable.Vector a), (Data.Vector.Storable.Vector a))] -> GHC.Types.Bool) -> a -> (a -> a) -> (a -> a) -> (Neuro.Network a) -> [((Data.Vector.Storable.Vector a), (Data.Vector.Storable.Vector a))] -> (Neuro.Network a)","ident":"Neuro.trainUntil","row":62,"col":1},"58":{"ann":"GHC.Types.Int","ident":"lq_anf$##7205759403792827708","row":62,"col":58},"41":{"ann":"[((Data.Vector.Storable.Vector a), (Data.Vector.Storable.Vector a))]","ident":"samples","row":62,"col":41},"54":{"ann":"{v : (Neuro.Network a) | v == net}","ident":"net","row":62,"col":54},"32":{"ann":"a -> a","ident":"act'","row":62,"col":32}},"95":{"22":{"ann":"a -> a","ident":"act'","row":95,"col":22},"17":{"ann":"(Data.Vector.Storable.Vector a) -> (Data.Vector.Storable.Vector a)","ident":"_","row":95,"col":17},"9":{"ann":"(Data.Vector.Storable.Vector a) -> (Data.Vector.Storable.Vector a)","ident":"deriv","row":95,"col":9}},"59":{"43":{"ann":"{v : GHC.Types.Int | v == n}","ident":"n","row":59,"col":43},"28":{"ann":"{v : GHC.Types.Bool | (v <=> k > n)\n                      && v == > k n}","ident":"_","row":59,"col":28},"13":{"ann":"GHC.Types.Int","ident":"n","row":59,"col":13},"30":{"ann":"GHC.Types.Int","ident":"k","row":59,"col":30},"1":{"ann":"forall a .\n(GHC.Float.Floating<[]> (Data.Vector.Storable.Vector a), GHC.Float.Floating<[]> a, Internal.Numeric.Numeric<[]> a, GHC.Num.Num<[]> (Data.Vector.Storable.Vector a), Internal.Numeric.Container<[]> Data.Vector.Storable.Vector a) =>\nGHC.Types.Int -> a -> (a -> a) -> (a -> a) -> (Neuro.Network a) -> [((Data.Vector.Storable.Vector a), (Data.Vector.Storable.Vector a))] -> (Neuro.Network a)","ident":"Neuro.trainNTimes","row":59,"col":1},"39":{"ann":"{v : GHC.Types.Int | v == k}","ident":"k","row":59,"col":39}},"52":{"40":{"ann":"{v : (Data.Binary.Get.Internal.Get [(Internal.Matrix.Matrix a)]) | v == get}","ident":"lq_anf$##7205759403792827525","row":52,"col":40},"20":{"ann":"{VV : forall a .\n      x1:[a] -> {v : (Data.Vector.Vector a) | vlen v == len x1} | VV == fromList}","ident":"_","row":52,"col":20},"3":{"ann":"forall a .\n(Internal.Matrix.Element<[]> a, Data.Binary.Class.Binary<[]> a) =>\n(Data.Binary.Get.Internal.Get (Neuro.Network a))","ident":"$cget","row":52,"col":3},"9":{"ann":"[(Internal.Matrix.Matrix a)] -> (Neuro.Network a)","ident":"lq_anf$##7205759403792827524","row":52,"col":9}},"69":{"73":{"ann":"{VV : forall a .\n      {v : (Data.Vector.Vector a) | v == empty} | VV == empty}","ident":"_","row":69,"col":73},"37":{"ann":"{VV : forall a b .\n      ((System.Random.MWC.Gen (Control.Monad.Primitive.PrimState (GHC.ST.ST a))) -> (GHC.ST.ST a b)) -> (System.Random.MWC.Gen (Control.Monad.Primitive.PrimState (GHC.ST.ST a))) -> (GHC.ST.ST a b) | VV == asGenST}","ident":"_","row":69,"col":37},"48":{"ann":"(System.Random.MWC.Gen (GHC.Types.Any (TYPE 'GHC.Types.LiftedRep)))","ident":"gen","row":69,"col":48},"18":{"ann":"((System.Random.MWC.Gen (Control.Monad.Primitive.PrimState (GHC.ST.ST (GHC.Types.Any (TYPE 'GHC.Types.LiftedRep))))) -> (GHC.ST.ST (GHC.Types.Any (TYPE 'GHC.Types.LiftedRep)) (Data.Vector.Vector (Internal.Matrix.Matrix a)))) -> (GHC.Types.IO (Data.Vector.Vector (Internal.Matrix.Matrix a)))","ident":"lq_anf$##7205759403792827593","row":69,"col":18},"62":{"ann":"{v : [(GHC.Types.Int, GHC.Types.Int)] | len v >= 0\n                                        && v == dimensions}","ident":"dimensions","row":69,"col":62},"47":{"ann":"{v : (Data.Vector.Vector (Internal.Matrix.Matrix a)) | v == empty}","ident":"lq_anf$##7205759403792827600","row":69,"col":47},"3":{"ann":"(GHC.Types.IO (Data.Vector.Vector (Internal.Matrix.Matrix a))) -> (GHC.Types.IO (Neuro.Network a))","ident":"lq_anf$##7205759403792827591","row":69,"col":3}},"87":{"61":{"ann":"(Data.Vector.Storable.Vector a)","ident":"lq_anf$##7205759403792827636","row":87,"col":61},"44":{"ann":"(Data.Vector.Storable.Vector a) -> (Internal.Matrix.Matrix a) -> (Data.Vector.Storable.Vector a)","ident":"f","row":87,"col":44},"53":{"ann":"{v : [(Data.Vector.Storable.Vector a)] | head v == input\n                                         && lqdc##$select v == input}","ident":"lq_anf$##7205759403792827639","row":87,"col":53},"35":{"ann":"(Data.Vector.Vector (Internal.Matrix.Matrix a))","ident":"lq_anf$##7205759403792827641","row":87,"col":35},"1":{"ann":"forall a .\n(GHC.Float.Floating<[]> (Data.Vector.Storable.Vector a), Internal.Numeric.Numeric<[]> a, Foreign.Storable.Storable<[]> a, GHC.Num.Num<[]> (Data.Vector.Storable.Vector a)) =>\n(Neuro.Network a) -> (a -> a) -> (Data.Vector.Storable.Vector a) -> (Data.Vector.Vector (Data.Vector.Storable.Vector a))","ident":"Neuro.outputs","row":87,"col":1},"23":{"ann":"a -> a","ident":"act","row":87,"col":23},"46":{"ann":"(Data.Vector.Storable.Vector a)","ident":"lq_anf$##7205759403792827640","row":87,"col":46},"27":{"ann":"(Data.Vector.Storable.Vector a)","ident":"input","row":87,"col":27},"54":{"ann":"{v : (Data.Vector.Storable.Vector a) | v == input}","ident":"input","row":87,"col":54}},"117":{"15":{"ann":"{VV : a | VV == tanh x}","ident":"s","row":117,"col":15},"7":{"ann":"a","ident":"x","row":117,"col":7},"19":{"ann":"{VV : a | VV == tanh x}","ident":"_","row":117,"col":19},"1":{"ann":"forall a . (GHC.Float.Floating<[]> a) => a -> a","ident":"Neuro.tanh'","row":117,"col":1},"24":{"ann":"{VV : a | VV == x}","ident":"x","row":117,"col":24}},"121":{"51":{"ann":"{v : (GHC.Types.IO Data.ByteString.Lazy.Internal.ByteString) | v == readFile fp}","ident":"lq_anf$##7205759403792827720","row":121,"col":51},"13":{"ann":"[GHC.Types.Char]","ident":"fp","row":121,"col":13},"36":{"ann":"Data.ByteString.Lazy.Internal.ByteString -> Data.ByteString.Lazy.Internal.ByteString","ident":"Codec.Compression.Zlib.decompress","row":121,"col":36},"1":{"ann":"forall a .\n(Foreign.Storable.Storable<[]> a, Internal.Matrix.Element<[]> a, Data.Binary.Class.Binary<[]> a) =>\n[GHC.Types.Char] -> (GHC.Types.IO (Neuro.Network a))","ident":"Neuro.loadNetwork","row":121,"col":1},"18":{"ann":"{VV : forall a . a -> (GHC.Types.IO a) | VV == return}","ident":"_","row":121,"col":18},"27":{"ann":"Data.ByteString.Lazy.Internal.ByteString -> (Neuro.Network a)","ident":"lq_anf$##7205759403792827717","row":121,"col":27},"63":{"ann":"{v : [GHC.Types.Char] | len v >= 0\n                        && v == fp}","ident":"fp","row":121,"col":63}},"64":{"78":{"ann":"{v : [((Data.Vector.Storable.Vector a), (Data.Vector.Storable.Vector a))] | len v >= 0\n                                                                            && v == samples}","ident":"samples","row":64,"col":78},"71":{"ann":"a -> a","ident":"act'","row":64,"col":71},"67":{"ann":"a -> a","ident":"act","row":64,"col":67},"41":{"ann":"{v : (Neuro.Network a) | v == backpropOnce learningRate act act' n samples}","ident":"_","row":64,"col":41},"54":{"ann":"{VV : a | VV == learningRate}","ident":"learningRate","row":64,"col":54},"76":{"ann":"{v : (Neuro.Network a) | v == n}","ident":"n","row":64,"col":76}},"93":{"15":{"ann":"(Data.Vector.Vector (Data.Vector.Storable.Vector a))","ident":"lq_anf$##7205759403792827662","row":93,"col":15},"37":{"ann":"{v : (Data.Vector.Vector (Data.Vector.Storable.Vector a)) | 0 <= vlen v\n                                                            && v == os}","ident":"os","row":93,"col":37},"29":{"ann":"(Data.Vector.Vector ((Data.Vector.Storable.Vector a), (Internal.Matrix.Matrix a)))","ident":"lq_anf$##7205759403792827661","row":93,"col":29},"26":{"ann":"(Data.Vector.Storable.Vector a)","ident":"lq_anf$##7205759403792827659","row":93,"col":26},"24":{"ann":"((Data.Vector.Storable.Vector a), (Internal.Matrix.Matrix a)) -> (Data.Vector.Storable.Vector a) -> (Data.Vector.Storable.Vector a)","ident":"f","row":93,"col":24}},"94":{"37":{"ann":"{v : (Internal.Matrix.Matrix a) | v == tr m}","ident":"lq_anf$##7205759403792827646","row":94,"col":37},"36":{"ann":"(Data.Vector.Storable.Vector a)","ident":"lq_anf$##7205759403792827647","row":94,"col":36},"45":{"ann":"{v : (Data.Vector.Storable.Vector a) | v == del}","ident":"lq_anf$##7205759403792827644","row":94,"col":45},"40":{"ann":"{v : (Internal.Matrix.Matrix a) | v == m}","ident":"m","row":94,"col":40},"26":{"ann":"(Data.Vector.Storable.Vector a)","ident":"lq_anf$##7205759403792827645","row":94,"col":26},"20":{"ann":"(Data.Vector.Storable.Vector a)","ident":"del","row":94,"col":20},"9":{"ann":"((Data.Vector.Storable.Vector a), (Internal.Matrix.Matrix a)) -> (Data.Vector.Storable.Vector a) -> (Data.Vector.Storable.Vector a)","ident":"f","row":94,"col":9},"32":{"ann":"{v : (Data.Vector.Storable.Vector a) | v == o}","ident":"lq_anf$##7205759403792827643","row":94,"col":32}},"63":{"15":{"ann":"GHC.Types.Int","ident":"k","row":63,"col":15},"36":{"ann":"{v : (Neuro.Network a) | v == n}","ident":"n","row":63,"col":36},"22":{"ann":"{v : GHC.Types.Int | v == k}","ident":"lq_anf$##7205759403792827700","row":63,"col":22},"19":{"ann":"GHC.Types.Bool","ident":"lq_anf$##7205759403792827701","row":63,"col":19},"12":{"ann":"(Neuro.Network a)","ident":"n","row":63,"col":12},"26":{"ann":"{v : [((Data.Vector.Storable.Vector a), (Data.Vector.Storable.Vector a))] | len v >= 0\n                                                                            && v == samples}","ident":"samples","row":63,"col":26},"24":{"ann":"{v : (Neuro.Network a) | v == n}","ident":"n","row":63,"col":24},"9":{"ann":"(Neuro.Network a) -> GHC.Types.Int -> (Neuro.Network a)","ident":"go","row":63,"col":9}},"99":{"25":{"ann":"{v : (Neuro.Network a) | v == n}","ident":"n","row":99,"col":25},"31":{"ann":"{v : (Data.Vector.Storable.Vector a) | v == input}","ident":"input","row":99,"col":31},"17":{"ann":"{v : (Data.Vector.Vector (Data.Vector.Storable.Vector a)) | v == outputs n act input}","ident":"lq_anf$##7205759403792827675","row":99,"col":17},"27":{"ann":"a -> a","ident":"act","row":99,"col":27}},"80":{"1":{"ann":"forall a .\n(Foreign.Storable.Storable<[]> a) =>\n(Data.Vector.Vector (Internal.Matrix.Matrix a)) -> (Neuro.Network a)","ident":"Neuro.fromWeightMatrices","row":80,"col":1},"20":{"ann":"(Data.Vector.Vector (Internal.Matrix.Matrix a))","ident":"ws","row":80,"col":20}},"109":{"28":{"ann":"(Neuro.Network a)","ident":"n","row":109,"col":28},"14":{"ann":"a","ident":"rate","row":109,"col":14},"19":{"ann":"a -> a","ident":"act","row":109,"col":19},"30":{"ann":"[((Data.Vector.Storable.Vector a), (Data.Vector.Storable.Vector a))]","ident":"samples","row":109,"col":30},"71":{"ann":"a -> a","ident":"act'","row":109,"col":71},"67":{"ann":"a -> a","ident":"act","row":109,"col":67},"1":{"ann":"forall a .\n(GHC.Float.Floating<[]> (Data.Vector.Storable.Vector a), GHC.Float.Floating<[]> a, Internal.Numeric.Numeric<[]> a, GHC.Num.Num<[]> (Data.Vector.Storable.Vector a), Internal.Numeric.Container<[]> Data.Vector.Storable.Vector a) =>\na -> (a -> a) -> (a -> a) -> (Neuro.Network a) -> [((Data.Vector.Storable.Vector a), (Data.Vector.Storable.Vector a))] -> (Neuro.Network a)","ident":"Neuro.backpropOnce","row":109,"col":1},"23":{"ann":"a -> a","ident":"act'","row":109,"col":23},"62":{"ann":"{VV : a | VV == rate}","ident":"rate","row":109,"col":62},"77":{"ann":"{v : (Neuro.Network a) | v == n}","ident":"n","row":109,"col":77},"47":{"ann":"(Neuro.Network a) -> ((Data.Vector.Storable.Vector a), (Data.Vector.Storable.Vector a)) -> (Neuro.Network a)","ident":"lq_anf$##7205759403792827698","row":109,"col":47},"79":{"ann":"{v : [((Data.Vector.Storable.Vector a), (Data.Vector.Storable.Vector a))] | len v >= 0\n                                                                            && v == samples}","ident":"samples","row":109,"col":79}},"77":{"31":{"ann":"{v : [GHC.Types.Int] | tail v == hiddens\n                       && lqdc##$select v == hiddens\n                       && len v == 1 + len hiddens}","ident":"lq_anf$##7205759403792827565","row":77,"col":31},"44":{"ann":"{v : [GHC.Types.Int] | len v >= 0\n                       && v == hiddens}","ident":"hiddens","row":77,"col":44},"40":{"ann":"GHC.Types.Int","ident":"lq_anf$##7205759403792827563","row":77,"col":40},"32":{"ann":"{v : GHC.Types.Int | v == nInputs}","ident":"nInputs","row":77,"col":32}},"65":{"37":{"ann":"{v : (Neuro.Network a) | v == backpropOnce learningRate act act' n samples}","ident":"n'","row":65,"col":37},"43":{"ann":"(Neuro.Network a) -> GHC.Types.Int -> (Neuro.Network a)","ident":"go","row":65,"col":43},"49":{"ann":"GHC.Types.Int","ident":"lq_anf$##7205759403792827705","row":65,"col":49},"50":{"ann":"{v : GHC.Types.Int | v == k}","ident":"lq_anf$##7205759403792827700","row":65,"col":50},"52":{"ann":"GHC.Types.Int","ident":"lq_anf$##7205759403792827704","row":65,"col":52},"46":{"ann":"{v : (Neuro.Network a) | v == backpropOnce learningRate act act' n samples\n                         && v == n'}","ident":"n'","row":65,"col":46}},"92":{"15":{"ann":"(Data.Vector.Storable.Vector a)","ident":"lq_anf$##7205759403792827655","row":92,"col":15},"50":{"ann":"{v : (Data.Vector.Storable.Vector a) | v == last os}","ident":"lq_anf$##7205759403792827656","row":92,"col":50},"29":{"ann":"{v : (Data.Vector.Storable.Vector a) | v == expected}","ident":"expected","row":92,"col":29},"16":{"ann":"{v : (Data.Vector.Storable.Vector a) | v == last os}","ident":"lq_anf$##7205759403792827654","row":92,"col":16},"58":{"ann":"{v : (Data.Vector.Vector (Data.Vector.Storable.Vector a)) | 0 <= vlen v\n                                                            && v == os}","ident":"os","row":92,"col":58},"41":{"ann":"(Data.Vector.Storable.Vector a)","ident":"lq_anf$##7205759403792827657","row":92,"col":41},"24":{"ann":"{v : (Data.Vector.Vector (Data.Vector.Storable.Vector a)) | 0 <= vlen v\n                                                            && v == os}","ident":"os","row":92,"col":24},"42":{"ann":"(Data.Vector.Storable.Vector a) -> (Data.Vector.Storable.Vector a)","ident":"deriv","row":92,"col":42}},"76":{"43":{"ann":"{v : [GHC.Types.Int] | head v == nOutputs\n                       && lqdc##$select v == nOutputs}","ident":"lq_anf$##7205759403792827559","row":76,"col":43},"31":{"ann":"[GHC.Types.Int]","ident":"lq_anf$##7205759403792827560","row":76,"col":31},"44":{"ann":"{v : GHC.Types.Int | v == nOutputs}","ident":"nOutputs","row":76,"col":44},"27":{"ann":"x1:[GHC.Types.Int] -> {v : [(GHC.Types.Int, GHC.Types.Int)] | len v <= len x1}","ident":"lq_anf$##7205759403792827561","row":76,"col":27},"9":{"ann":"[(GHC.Types.Int, GHC.Types.Int)]","ident":"dimensions","row":76,"col":9},"32":{"ann":"{v : [GHC.Types.Int] | len v >= 0\n                       && v == hiddens}","ident":"hiddens","row":76,"col":32}},"98":{"15":{"ann":"a","ident":"alpha","row":98,"col":15},"106":{"ann":"{v : (Data.Vector.Vector (Internal.Matrix.Matrix a)) | 0 <= vlen v}","ident":"lq_anf$##7205759403792827682","row":98,"col":106},"25":{"ann":"a -> a","ident":"act'","row":98,"col":25},"82":{"ann":"(Data.Vector.Vector (Internal.Matrix.Matrix a))","ident":"lq_anf$##7205759403792827686","row":98,"col":82},"72":{"ann":"v_B1:(Data.Vector.Vector (Internal.Matrix.Matrix a)) -> {VV : (Neuro.Network a) | VV ~~ v_B1}","ident":"lq_anf$##7205759403792827683","row":98,"col":72},"30":{"ann":"(Neuro.Network a)","ident":"n","row":98,"col":30},"1":{"ann":"forall a .\n(GHC.Float.Floating<[]> (Data.Vector.Storable.Vector a), GHC.Float.Floating<[]> a, Internal.Numeric.Numeric<[]> a, Foreign.Storable.Storable<[]> a, GHC.Num.Num<[]> (Data.Vector.Storable.Vector a), Internal.Numeric.Container<[]> Data.Vector.Storable.Vector a) =>\na -> (a -> a) -> (a -> a) -> (Neuro.Network a) -> ((Data.Vector.Storable.Vector a), (Data.Vector.Storable.Vector a)) -> (Neuro.Network a)","ident":"Neuro.updateNetwork","row":98,"col":1},"93":{"ann":"x1:(Internal.Matrix.Matrix a) -> x2:(Internal.Matrix.Matrix a) -> {v : (Internal.Matrix.Matrix a) | v == x1 + x2}","ident":"lq_anf$##7205759403792827684","row":98,"col":93},"21":{"ann":"a -> a","ident":"act","row":98,"col":21}}},"sptypes":[{"start":{"line":1,"column":1},"ann":"GHC.Types.Module","ident":"Neuro.$trModule","stop":{"line":1,"column":1}},{"start":{"line":50,"column":10},"ann":"forall a .\n(Internal.Matrix.Element<[]> a, Data.Binary.Class.Binary<[]> a) =>\n(Data.Binary.Class.Binary (Neuro.Network a))","ident":"Neuro.$fBinaryNetwork","stop":{"line":50,"column":53}},{"start":{"line":51,"column":3},"ann":"forall a .\n(Internal.Matrix.Element<[]> a, Data.Binary.Class.Binary<[]> a) =>\n(Neuro.Network a) -> (Data.Binary.Put.PutM ())","ident":"$cput","stop":{"line":51,"column":6}},{"start":{"line":51,"column":22},"ann":"[(Internal.Matrix.Matrix a)] -> (Data.Binary.Put.PutM ())","ident":"lq_anf$##7205759403792827526","stop":{"line":51,"column":25}},{"start":{"line":51,"column":28},"ann":"{VV : forall a . (Data.Vector.Vector a) -> [a] | VV == toList}","ident":"_","stop":{"line":51,"column":37}},{"start":{"line":52,"column":3},"ann":"forall a .\n(Internal.Matrix.Element<[]> a, Data.Binary.Class.Binary<[]> a) =>\n(Data.Binary.Get.Internal.Get (Neuro.Network a))","ident":"$cget","stop":{"line":52,"column":6}},{"start":{"line":52,"column":9},"ann":"[(Internal.Matrix.Matrix a)] -> (Neuro.Network a)","ident":"lq_anf$##7205759403792827524","stop":{"line":52,"column":32}},{"start":{"line":52,"column":20},"ann":"{VV : forall a .\n      x1:[a] -> {v : (Data.Vector.Vector a) | vlen v == len x1} | VV == fromList}","ident":"_","stop":{"line":52,"column":31}},{"start":{"line":52,"column":40},"ann":"{v : (Data.Binary.Get.Internal.Get [(Internal.Matrix.Matrix a)]) | v == get}","ident":"lq_anf$##7205759403792827525","stop":{"line":52,"column":43}},{"start":{"line":59,"column":1},"ann":"forall a .\n(GHC.Float.Floating<[]> (Data.Vector.Storable.Vector a), GHC.Float.Floating<[]> a, Internal.Numeric.Numeric<[]> a, GHC.Num.Num<[]> (Data.Vector.Storable.Vector a), Internal.Numeric.Container<[]> Data.Vector.Storable.Vector a) =>\nGHC.Types.Int -> a -> (a -> a) -> (a -> a) -> (Neuro.Network a) -> [((Data.Vector.Storable.Vector a), (Data.Vector.Storable.Vector a))] -> (Neuro.Network a)","ident":"Neuro.trainNTimes","stop":{"line":59,"column":12}},{"start":{"line":59,"column":13},"ann":"GHC.Types.Int","ident":"n","stop":{"line":59,"column":14}},{"start":{"line":59,"column":28},"ann":"{v : GHC.Types.Bool | (v <=> k > n)\n                      && v == > k n}","ident":"_","stop":{"line":59,"column":45}},{"start":{"line":59,"column":30},"ann":"GHC.Types.Int","ident":"k","stop":{"line":59,"column":31}},{"start":{"line":59,"column":39},"ann":"{v : GHC.Types.Int | v == k}","ident":"k","stop":{"line":59,"column":40}},{"start":{"line":59,"column":43},"ann":"{v : GHC.Types.Int | v == n}","ident":"n","stop":{"line":59,"column":44}},{"start":{"line":62,"column":1},"ann":"forall a .\n(GHC.Float.Floating<[]> (Data.Vector.Storable.Vector a), GHC.Float.Floating<[]> a, Internal.Numeric.Numeric<[]> a, GHC.Num.Num<[]> (Data.Vector.Storable.Vector a), Internal.Numeric.Container<[]> Data.Vector.Storable.Vector a) =>\n(GHC.Types.Int -> (Neuro.Network a) -> [((Data.Vector.Storable.Vector a), (Data.Vector.Storable.Vector a))] -> GHC.Types.Bool) -> a -> (a -> a) -> (a -> a) -> (Neuro.Network a) -> [((Data.Vector.Storable.Vector a), (Data.Vector.Storable.Vector a))] -> (Neuro.Network a)","ident":"Neuro.trainUntil","stop":{"line":62,"column":11}},{"start":{"line":62,"column":12},"ann":"GHC.Types.Int -> (Neuro.Network a) -> [((Data.Vector.Storable.Vector a), (Data.Vector.Storable.Vector a))] -> GHC.Types.Bool","ident":"pr","stop":{"line":62,"column":14}},{"start":{"line":62,"column":15},"ann":"a","ident":"learningRate","stop":{"line":62,"column":27}},{"start":{"line":62,"column":28},"ann":"a -> a","ident":"act","stop":{"line":62,"column":31}},{"start":{"line":62,"column":32},"ann":"a -> a","ident":"act'","stop":{"line":62,"column":36}},{"start":{"line":62,"column":37},"ann":"(Neuro.Network a)","ident":"net","stop":{"line":62,"column":40}},{"start":{"line":62,"column":41},"ann":"[((Data.Vector.Storable.Vector a), (Data.Vector.Storable.Vector a))]","ident":"samples","stop":{"line":62,"column":48}},{"start":{"line":62,"column":51},"ann":"(Neuro.Network a) -> GHC.Types.Int -> (Neuro.Network a)","ident":"go","stop":{"line":62,"column":59}},{"start":{"line":62,"column":54},"ann":"{v : (Neuro.Network a) | v == net}","ident":"net","stop":{"line":62,"column":57}},{"start":{"line":62,"column":58},"ann":"GHC.Types.Int","ident":"lq_anf$##7205759403792827708","stop":{"line":62,"column":59}},{"start":{"line":63,"column":9},"ann":"(Neuro.Network a) -> GHC.Types.Int -> (Neuro.Network a)","ident":"go","stop":{"line":63,"column":11}},{"start":{"line":63,"column":12},"ann":"(Neuro.Network a)","ident":"n","stop":{"line":63,"column":13}},{"start":{"line":63,"column":15},"ann":"GHC.Types.Int","ident":"k","stop":{"line":63,"column":16}},{"start":{"line":63,"column":19},"ann":"GHC.Types.Bool","ident":"lq_anf$##7205759403792827701","stop":{"line":63,"column":33}},{"start":{"line":63,"column":22},"ann":"{v : GHC.Types.Int | v == k}","ident":"lq_anf$##7205759403792827700","stop":{"line":63,"column":23}},{"start":{"line":63,"column":24},"ann":"{v : (Neuro.Network a) | v == n}","ident":"n","stop":{"line":63,"column":25}},{"start":{"line":63,"column":26},"ann":"{v : [((Data.Vector.Storable.Vector a), (Data.Vector.Storable.Vector a))] | len v >= 0\n                                                                            && v == samples}","ident":"samples","stop":{"line":63,"column":33}},{"start":{"line":63,"column":36},"ann":"{v : (Neuro.Network a) | v == n}","ident":"n","stop":{"line":63,"column":37}},{"start":{"line":64,"column":41},"ann":"{v : (Neuro.Network a) | v == backpropOnce learningRate act act' n samples}","ident":"_","stop":{"line":64,"column":85}},{"start":{"line":64,"column":54},"ann":"{VV : a | VV == learningRate}","ident":"learningRate","stop":{"line":64,"column":66}},{"start":{"line":64,"column":67},"ann":"a -> a","ident":"act","stop":{"line":64,"column":70}},{"start":{"line":64,"column":71},"ann":"a -> a","ident":"act'","stop":{"line":64,"column":75}},{"start":{"line":64,"column":76},"ann":"{v : (Neuro.Network a) | v == n}","ident":"n","stop":{"line":64,"column":77}},{"start":{"line":64,"column":78},"ann":"{v : [((Data.Vector.Storable.Vector a), (Data.Vector.Storable.Vector a))] | len v >= 0\n                                                                            && v == samples}","ident":"samples","stop":{"line":64,"column":85}},{"start":{"line":65,"column":37},"ann":"{v : (Neuro.Network a) | v == backpropOnce learningRate act act' n samples}","ident":"n'","stop":{"line":65,"column":39}},{"start":{"line":65,"column":43},"ann":"(Neuro.Network a) -> GHC.Types.Int -> (Neuro.Network a)","ident":"go","stop":{"line":65,"column":54}},{"start":{"line":65,"column":46},"ann":"{v : (Neuro.Network a) | v == backpropOnce learningRate act act' n samples\n                         && v == n'}","ident":"n'","stop":{"line":65,"column":48}},{"start":{"line":65,"column":49},"ann":"GHC.Types.Int","ident":"lq_anf$##7205759403792827705","stop":{"line":65,"column":54}},{"start":{"line":65,"column":50},"ann":"{v : GHC.Types.Int | v == k}","ident":"lq_anf$##7205759403792827700","stop":{"line":65,"column":51}},{"start":{"line":65,"column":52},"ann":"GHC.Types.Int","ident":"lq_anf$##7205759403792827704","stop":{"line":65,"column":53}},{"start":{"line":68,"column":1},"ann":"forall a .\n(System.Random.MWC.Variate<[]> a, Foreign.Storable.Storable<[]> a) =>\nGHC.Types.Int -> [GHC.Types.Int] -> GHC.Types.Int -> (GHC.Types.IO (Neuro.Network a))","ident":"Neuro.createNetwork","stop":{"line":68,"column":14}},{"start":{"line":68,"column":15},"ann":"GHC.Types.Int","ident":"nInputs","stop":{"line":68,"column":22}},{"start":{"line":68,"column":23},"ann":"[GHC.Types.Int]","ident":"hiddens","stop":{"line":68,"column":30}},{"start":{"line":68,"column":31},"ann":"GHC.Types.Int","ident":"nOutputs","stop":{"line":68,"column":39}},{"start":{"line":69,"column":3},"ann":"(GHC.Types.IO (Data.Vector.Vector (Internal.Matrix.Matrix a))) -> (GHC.Types.IO (Neuro.Network a))","ident":"lq_anf$##7205759403792827591","stop":{"line":69,"column":15}},{"start":{"line":69,"column":18},"ann":"((System.Random.MWC.Gen (Control.Monad.Primitive.PrimState (GHC.ST.ST (GHC.Types.Any (TYPE 'GHC.Types.LiftedRep))))) -> (GHC.ST.ST (GHC.Types.Any (TYPE 'GHC.Types.LiftedRep)) (Data.Vector.Vector (Internal.Matrix.Matrix a)))) -> (GHC.Types.IO (Data.Vector.Vector (Internal.Matrix.Matrix a)))","ident":"lq_anf$##7205759403792827593","stop":{"line":69,"column":34}},{"start":{"line":69,"column":37},"ann":"{VV : forall a b .\n      ((System.Random.MWC.Gen (Control.Monad.Primitive.PrimState (GHC.ST.ST a))) -> (GHC.ST.ST a b)) -> (System.Random.MWC.Gen (Control.Monad.Primitive.PrimState (GHC.ST.ST a))) -> (GHC.ST.ST a b) | VV == asGenST}","ident":"_","stop":{"line":69,"column":44}},{"start":{"line":69,"column":47},"ann":"{v : (Data.Vector.Vector (Internal.Matrix.Matrix a)) | v == empty}","ident":"lq_anf$##7205759403792827600","stop":{"line":69,"column":81}},{"start":{"line":69,"column":48},"ann":"(System.Random.MWC.Gen (GHC.Types.Any (TYPE 'GHC.Types.LiftedRep)))","ident":"gen","stop":{"line":69,"column":51}},{"start":{"line":69,"column":62},"ann":"{v : [(GHC.Types.Int, GHC.Types.Int)] | len v >= 0\n                                        && v == dimensions}","ident":"dimensions","stop":{"line":69,"column":72}},{"start":{"line":69,"column":73},"ann":"{VV : forall a .\n      {v : (Data.Vector.Vector a) | v == empty} | VV == empty}","ident":"_","stop":{"line":69,"column":81}},{"start":{"line":71,"column":9},"ann":"(System.Random.MWC.Gen (Control.Monad.Primitive.PrimState a)) -> [(GHC.Types.Int, GHC.Types.Int)] -> (Data.Vector.Vector (Internal.Matrix.Matrix b)) -> a (Data.Vector.Vector (Internal.Matrix.Matrix b))","ident":"go","stop":{"line":71,"column":11}},{"start":{"line":71,"column":18},"ann":"(Data.Vector.Vector (Internal.Matrix.Matrix a))","ident":"ms","stop":{"line":71,"column":20}},{"start":{"line":71,"column":31},"ann":"{v : (GHC.Base.Monad a) | v == $p1PrimMonad\n                          && v == $dMonad_a7JV}","ident":"$dMonad_a7JV","stop":{"line":71,"column":40}},{"start":{"line":71,"column":38},"ann":"{v : (Data.Vector.Vector (Internal.Matrix.Matrix a)) | 0 <= vlen v\n                                                       && v == ms}","ident":"lq_anf$##7205759403792827572","stop":{"line":71,"column":40}},{"start":{"line":73,"column":12},"ann":"(Internal.Matrix.Matrix a)","ident":"mat","stop":{"line":73,"column":15}},{"start":{"line":73,"column":19},"ann":"a (Internal.Matrix.Matrix b)","ident":"_","stop":{"line":73,"column":36}},{"start":{"line":73,"column":29},"ann":"{v : GHC.Types.Int | v == n}","ident":"lq_anf$##7205759403792827577","stop":{"line":73,"column":30}},{"start":{"line":73,"column":31},"ann":"{v : GHC.Types.Int | v == m}","ident":"lq_anf$##7205759403792827578","stop":{"line":73,"column":32}},{"start":{"line":73,"column":33},"ann":"(System.Random.MWC.Gen (Control.Monad.Primitive.PrimState a))","ident":"ds_d8IR","stop":{"line":73,"column":36}},{"start":{"line":74,"column":11},"ann":"(System.Random.MWC.Gen (Control.Monad.Primitive.PrimState a)) -> [(GHC.Types.Int, GHC.Types.Int)] -> (Data.Vector.Vector (Internal.Matrix.Matrix b)) -> a (Data.Vector.Vector (Internal.Matrix.Matrix b))","ident":"go","stop":{"line":74,"column":39}},{"start":{"line":74,"column":14},"ann":"(System.Random.MWC.Gen (Control.Monad.Primitive.PrimState a))","ident":"ds_d8IR","stop":{"line":74,"column":17}},{"start":{"line":74,"column":18},"ann":"{v : [(GHC.Types.Int, GHC.Types.Int)] | len v >= 0\n                                        && v == ds}","ident":"ds","stop":{"line":74,"column":20}},{"start":{"line":74,"column":21},"ann":"(Data.Vector.Vector (Internal.Matrix.Matrix a))","ident":"lq_anf$##7205759403792827580","stop":{"line":74,"column":39}},{"start":{"line":74,"column":22},"ann":"{v : (Data.Vector.Vector (Internal.Matrix.Matrix a)) | 0 <= vlen v\n                                                       && v == ms}","ident":"ms","stop":{"line":74,"column":24}},{"start":{"line":74,"column":35},"ann":"{v : (Internal.Matrix.Matrix a) | v == mat}","ident":"lq_anf$##7205759403792827579","stop":{"line":74,"column":38}},{"start":{"line":75,"column":9},"ann":"forall a b .\n(Foreign.Storable.Storable<[]> b, Control.Monad.Primitive.PrimMonad<[]> a, System.Random.MWC.Variate<[]> b) =>\nGHC.Types.Int -> GHC.Types.Int -> (System.Random.MWC.Gen (Control.Monad.Primitive.PrimState a)) -> a (Internal.Matrix.Matrix b)","ident":"randomMat","stop":{"line":75,"column":18}},{"start":{"line":75,"column":19},"ann":"GHC.Types.Int","ident":"n","stop":{"line":75,"column":20}},{"start":{"line":75,"column":21},"ann":"GHC.Types.Int","ident":"m","stop":{"line":75,"column":22}},{"start":{"line":75,"column":23},"ann":"(System.Random.MWC.Gen (Control.Monad.Primitive.PrimState a))","ident":"g","stop":{"line":75,"column":24}},{"start":{"line":75,"column":27},"ann":"(Data.Vector.Storable.Vector a) -> (Internal.Matrix.Matrix a)","ident":"lq_anf$##7205759403792827568","stop":{"line":75,"column":36}},{"start":{"line":75,"column":35},"ann":"{v : GHC.Types.Int | v == m}","ident":"m","stop":{"line":75,"column":36}},{"start":{"line":75,"column":44},"ann":"a (Data.Vector.Storable.Vector b)","ident":"lq_anf$##7205759403792827570","stop":{"line":75,"column":65}},{"start":{"line":75,"column":58},"ann":"{v : (System.Random.MWC.Gen (Control.Monad.Primitive.PrimState a)) | v == g}","ident":"g","stop":{"line":75,"column":59}},{"start":{"line":75,"column":60},"ann":"{v : GHC.Types.Int | v == n * m\n                     && v == * n m}","ident":"lq_anf$##7205759403792827569","stop":{"line":75,"column":65}},{"start":{"line":75,"column":61},"ann":"{v : GHC.Types.Int | v == n}","ident":"n","stop":{"line":75,"column":62}},{"start":{"line":75,"column":63},"ann":"{v : GHC.Types.Int | v == m}","ident":"m","stop":{"line":75,"column":64}},{"start":{"line":76,"column":9},"ann":"[(GHC.Types.Int, GHC.Types.Int)]","ident":"dimensions","stop":{"line":76,"column":19}},{"start":{"line":76,"column":27},"ann":"x1:[GHC.Types.Int] -> {v : [(GHC.Types.Int, GHC.Types.Int)] | len v <= len x1}","ident":"lq_anf$##7205759403792827561","stop":{"line":76,"column":54}},{"start":{"line":76,"column":31},"ann":"[GHC.Types.Int]","ident":"lq_anf$##7205759403792827560","stop":{"line":76,"column":54}},{"start":{"line":76,"column":32},"ann":"{v : [GHC.Types.Int] | len v >= 0\n                       && v == hiddens}","ident":"hiddens","stop":{"line":76,"column":39}},{"start":{"line":76,"column":43},"ann":"{v : [GHC.Types.Int] | head v == nOutputs\n                       && lqdc##$select v == nOutputs}","ident":"lq_anf$##7205759403792827559","stop":{"line":76,"column":53}},{"start":{"line":76,"column":44},"ann":"{v : GHC.Types.Int | v == nOutputs}","ident":"nOutputs","stop":{"line":76,"column":52}},{"start":{"line":77,"column":31},"ann":"{v : [GHC.Types.Int] | tail v == hiddens\n                       && lqdc##$select v == hiddens\n                       && len v == 1 + len hiddens}","ident":"lq_anf$##7205759403792827565","stop":{"line":77,"column":52}},{"start":{"line":77,"column":32},"ann":"{v : GHC.Types.Int | v == nInputs}","ident":"nInputs","stop":{"line":77,"column":39}},{"start":{"line":77,"column":40},"ann":"GHC.Types.Int","ident":"lq_anf$##7205759403792827563","stop":{"line":77,"column":41}},{"start":{"line":77,"column":44},"ann":"{v : [GHC.Types.Int] | len v >= 0\n                       && v == hiddens}","ident":"hiddens","stop":{"line":77,"column":51}},{"start":{"line":80,"column":1},"ann":"forall a .\n(Foreign.Storable.Storable<[]> a) =>\n(Data.Vector.Vector (Internal.Matrix.Matrix a)) -> (Neuro.Network a)","ident":"Neuro.fromWeightMatrices","stop":{"line":80,"column":19}},{"start":{"line":80,"column":20},"ann":"(Data.Vector.Vector (Internal.Matrix.Matrix a))","ident":"ws","stop":{"line":80,"column":22}},{"start":{"line":83,"column":1},"ann":"forall a .\n(GHC.Float.Floating<[]> (Data.Vector.Storable.Vector a), Internal.Numeric.Numeric<[]> a, Foreign.Storable.Storable<[]> a, GHC.Num.Num<[]> (Data.Vector.Storable.Vector a)) =>\n(Neuro.Network a) -> (a -> a) -> (Data.Vector.Storable.Vector a) -> (Data.Vector.Storable.Vector a)","ident":"Neuro.output","stop":{"line":83,"column":7}},{"start":{"line":83,"column":22},"ann":"a -> a","ident":"act","stop":{"line":83,"column":25}},{"start":{"line":83,"column":26},"ann":"(Data.Vector.Storable.Vector a)","ident":"input","stop":{"line":83,"column":31}},{"start":{"line":83,"column":34},"ann":"(Data.Vector.Vector (Internal.Matrix.Matrix a))","ident":"lq_anf$##7205759403792827616","stop":{"line":83,"column":73}},{"start":{"line":83,"column":44},"ann":"(Data.Vector.Storable.Vector a) -> (Internal.Matrix.Matrix a) -> (Data.Vector.Storable.Vector a)","ident":"f","stop":{"line":83,"column":45}},{"start":{"line":83,"column":46},"ann":"(Data.Vector.Storable.Vector a)","ident":"lq_anf$##7205759403792827615","stop":{"line":83,"column":64}},{"start":{"line":83,"column":53},"ann":"{v : [(Data.Vector.Storable.Vector a)] | head v == input\n                                         && lqdc##$select v == input}","ident":"lq_anf$##7205759403792827614","stop":{"line":83,"column":63}},{"start":{"line":83,"column":54},"ann":"{v : (Data.Vector.Storable.Vector a) | v == input}","ident":"input","stop":{"line":83,"column":59}},{"start":{"line":83,"column":61},"ann":"(Data.Vector.Storable.Vector a)","ident":"lq_anf$##7205759403792827611","stop":{"line":83,"column":62}},{"start":{"line":84,"column":9},"ann":"(Data.Vector.Storable.Vector a) -> (Internal.Matrix.Matrix a) -> (Data.Vector.Storable.Vector a)","ident":"f","stop":{"line":84,"column":10}},{"start":{"line":84,"column":12},"ann":"(Data.Vector.Storable.Vector a)","ident":"inp","stop":{"line":84,"column":15}},{"start":{"line":84,"column":16},"ann":"(Internal.Matrix.Matrix a)","ident":"m","stop":{"line":84,"column":17}},{"start":{"line":84,"column":20},"ann":"(Data.Vector.Storable.Vector a) -> (Data.Vector.Storable.Vector a)","ident":"lq_anf$##7205759403792827605","stop":{"line":84,"column":28}},{"start":{"line":84,"column":25},"ann":"a -> a","ident":"act","stop":{"line":84,"column":28}},{"start":{"line":84,"column":31},"ann":"{v : (Internal.Matrix.Matrix a) | v == m}","ident":"m","stop":{"line":84,"column":32}},{"start":{"line":84,"column":36},"ann":"{v : (Data.Vector.Storable.Vector a) | v == inp}","ident":"lq_anf$##7205759403792827604","stop":{"line":84,"column":39}},{"start":{"line":87,"column":1},"ann":"forall a .\n(GHC.Float.Floating<[]> (Data.Vector.Storable.Vector a), Internal.Numeric.Numeric<[]> a, Foreign.Storable.Storable<[]> a, GHC.Num.Num<[]> (Data.Vector.Storable.Vector a)) =>\n(Neuro.Network a) -> (a -> a) -> (Data.Vector.Storable.Vector a) -> (Data.Vector.Vector (Data.Vector.Storable.Vector a))","ident":"Neuro.outputs","stop":{"line":87,"column":8}},{"start":{"line":87,"column":23},"ann":"a -> a","ident":"act","stop":{"line":87,"column":26}},{"start":{"line":87,"column":27},"ann":"(Data.Vector.Storable.Vector a)","ident":"input","stop":{"line":87,"column":32}},{"start":{"line":87,"column":35},"ann":"(Data.Vector.Vector (Internal.Matrix.Matrix a))","ident":"lq_anf$##7205759403792827641","stop":{"line":87,"column":73}},{"start":{"line":87,"column":44},"ann":"(Data.Vector.Storable.Vector a) -> (Internal.Matrix.Matrix a) -> (Data.Vector.Storable.Vector a)","ident":"f","stop":{"line":87,"column":45}},{"start":{"line":87,"column":46},"ann":"(Data.Vector.Storable.Vector a)","ident":"lq_anf$##7205759403792827640","stop":{"line":87,"column":64}},{"start":{"line":87,"column":53},"ann":"{v : [(Data.Vector.Storable.Vector a)] | head v == input\n                                         && lqdc##$select v == input}","ident":"lq_anf$##7205759403792827639","stop":{"line":87,"column":63}},{"start":{"line":87,"column":54},"ann":"{v : (Data.Vector.Storable.Vector a) | v == input}","ident":"input","stop":{"line":87,"column":59}},{"start":{"line":87,"column":61},"ann":"(Data.Vector.Storable.Vector a)","ident":"lq_anf$##7205759403792827636","stop":{"line":87,"column":62}},{"start":{"line":88,"column":9},"ann":"(Data.Vector.Storable.Vector a) -> (Internal.Matrix.Matrix a) -> (Data.Vector.Storable.Vector a)","ident":"f","stop":{"line":88,"column":10}},{"start":{"line":88,"column":12},"ann":"(Data.Vector.Storable.Vector a)","ident":"inp","stop":{"line":88,"column":15}},{"start":{"line":88,"column":16},"ann":"(Internal.Matrix.Matrix a)","ident":"m","stop":{"line":88,"column":17}},{"start":{"line":88,"column":20},"ann":"(Data.Vector.Storable.Vector a) -> (Data.Vector.Storable.Vector a)","ident":"lq_anf$##7205759403792827630","stop":{"line":88,"column":28}},{"start":{"line":88,"column":25},"ann":"a -> a","ident":"act","stop":{"line":88,"column":28}},{"start":{"line":88,"column":31},"ann":"{v : (Internal.Matrix.Matrix a) | v == m}","ident":"m","stop":{"line":88,"column":32}},{"start":{"line":88,"column":36},"ann":"{v : (Data.Vector.Storable.Vector a) | v == inp}","ident":"lq_anf$##7205759403792827629","stop":{"line":88,"column":39}},{"start":{"line":91,"column":1},"ann":"forall a .\n(GHC.Float.Floating<[]> (Data.Vector.Storable.Vector a), GHC.Float.Floating<[]> a, Internal.Numeric.Numeric<[]> a, Internal.Numeric.Container<[]> Data.Vector.Storable.Vector a, GHC.Num.Num<[]> (Data.Vector.Storable.Vector a)) =>\n(Neuro.Network a) -> (a -> a) -> (Data.Vector.Vector (Data.Vector.Storable.Vector a)) -> (Data.Vector.Storable.Vector a) -> (Data.Vector.Vector (Internal.Matrix.Matrix a))","ident":"Neuro.deltas","stop":{"line":91,"column":7}},{"start":{"line":91,"column":22},"ann":"a -> a","ident":"act'","stop":{"line":91,"column":26}},{"start":{"line":91,"column":27},"ann":"(Data.Vector.Vector (Data.Vector.Storable.Vector a))","ident":"os","stop":{"line":91,"column":29}},{"start":{"line":91,"column":30},"ann":"(Data.Vector.Storable.Vector a)","ident":"expected","stop":{"line":91,"column":38}},{"start":{"line":91,"column":41},"ann":"{VV : forall a b c .\n      (a -> b -> c) -> (Data.Vector.Vector a) -> (Data.Vector.Vector b) -> (Data.Vector.Vector c) | VV == zipWith}","ident":"Data.Vector.zipWith","stop":{"line":91,"column":83}},{"start":{"line":91,"column":52},"ann":"(Data.Vector.Storable.Vector a) -> (Data.Vector.Storable.Vector a) -> (Internal.Matrix.Matrix a)","ident":"lq_anf$##7205759403792827664","stop":{"line":91,"column":57}},{"start":{"line":91,"column":58},"ann":"(Data.Vector.Vector (Data.Vector.Storable.Vector a))","ident":"lq_anf$##7205759403792827665","stop":{"line":91,"column":70}},{"start":{"line":91,"column":67},"ann":"{v : (Data.Vector.Vector (Data.Vector.Storable.Vector a)) | 0 <= vlen v}","ident":"lq_anf$##7205759403792827663","stop":{"line":91,"column":69}},{"start":{"line":91,"column":71},"ann":"{v : (Data.Vector.Vector (Data.Vector.Storable.Vector a)) | v == init os}","ident":"lq_anf$##7205759403792827666","stop":{"line":91,"column":83}},{"start":{"line":91,"column":80},"ann":"{v : (Data.Vector.Vector (Data.Vector.Storable.Vector a)) | 0 <= vlen v\n                                                            && v == os}","ident":"os","stop":{"line":91,"column":82}},{"start":{"line":92,"column":15},"ann":"(Data.Vector.Storable.Vector a)","ident":"lq_anf$##7205759403792827655","stop":{"line":92,"column":38}},{"start":{"line":92,"column":16},"ann":"{v : (Data.Vector.Storable.Vector a) | v == last os}","ident":"lq_anf$##7205759403792827654","stop":{"line":92,"column":26}},{"start":{"line":92,"column":24},"ann":"{v : (Data.Vector.Vector (Data.Vector.Storable.Vector a)) | 0 <= vlen v\n                                                            && v == os}","ident":"os","stop":{"line":92,"column":26}},{"start":{"line":92,"column":29},"ann":"{v : (Data.Vector.Storable.Vector a) | v == expected}","ident":"expected","stop":{"line":92,"column":37}},{"start":{"line":92,"column":41},"ann":"(Data.Vector.Storable.Vector a)","ident":"lq_anf$##7205759403792827657","stop":{"line":92,"column":61}},{"start":{"line":92,"column":42},"ann":"(Data.Vector.Storable.Vector a) -> (Data.Vector.Storable.Vector a)","ident":"deriv","stop":{"line":92,"column":47}},{"start":{"line":92,"column":50},"ann":"{v : (Data.Vector.Storable.Vector a) | v == last os}","ident":"lq_anf$##7205759403792827656","stop":{"line":92,"column":60}},{"start":{"line":92,"column":58},"ann":"{v : (Data.Vector.Vector (Data.Vector.Storable.Vector a)) | 0 <= vlen v\n                                                            && v == os}","ident":"os","stop":{"line":92,"column":60}},{"start":{"line":93,"column":15},"ann":"(Data.Vector.Vector (Data.Vector.Storable.Vector a))","ident":"lq_anf$##7205759403792827662","stop":{"line":93,"column":49}},{"start":{"line":93,"column":24},"ann":"((Data.Vector.Storable.Vector a), (Internal.Matrix.Matrix a)) -> (Data.Vector.Storable.Vector a) -> (Data.Vector.Storable.Vector a)","ident":"f","stop":{"line":93,"column":25}},{"start":{"line":93,"column":26},"ann":"(Data.Vector.Storable.Vector a)","ident":"lq_anf$##7205759403792827659","stop":{"line":93,"column":28}},{"start":{"line":93,"column":29},"ann":"(Data.Vector.Vector ((Data.Vector.Storable.Vector a), (Internal.Matrix.Matrix a)))","ident":"lq_anf$##7205759403792827661","stop":{"line":93,"column":49}},{"start":{"line":93,"column":37},"ann":"{v : (Data.Vector.Vector (Data.Vector.Storable.Vector a)) | 0 <= vlen v\n                                                            && v == os}","ident":"os","stop":{"line":93,"column":39}},{"start":{"line":94,"column":9},"ann":"((Data.Vector.Storable.Vector a), (Internal.Matrix.Matrix a)) -> (Data.Vector.Storable.Vector a) -> (Data.Vector.Storable.Vector a)","ident":"f","stop":{"line":94,"column":10}},{"start":{"line":94,"column":20},"ann":"(Data.Vector.Storable.Vector a)","ident":"del","stop":{"line":94,"column":23}},{"start":{"line":94,"column":26},"ann":"(Data.Vector.Storable.Vector a)","ident":"lq_anf$##7205759403792827645","stop":{"line":94,"column":33}},{"start":{"line":94,"column":32},"ann":"{v : (Data.Vector.Storable.Vector a) | v == o}","ident":"lq_anf$##7205759403792827643","stop":{"line":94,"column":33}},{"start":{"line":94,"column":36},"ann":"(Data.Vector.Storable.Vector a)","ident":"lq_anf$##7205759403792827647","stop":{"line":94,"column":49}},{"start":{"line":94,"column":37},"ann":"{v : (Internal.Matrix.Matrix a) | v == tr m}","ident":"lq_anf$##7205759403792827646","stop":{"line":94,"column":41}},{"start":{"line":94,"column":40},"ann":"{v : (Internal.Matrix.Matrix a) | v == m}","ident":"m","stop":{"line":94,"column":41}},{"start":{"line":94,"column":45},"ann":"{v : (Data.Vector.Storable.Vector a) | v == del}","ident":"lq_anf$##7205759403792827644","stop":{"line":94,"column":48}},{"start":{"line":95,"column":9},"ann":"(Data.Vector.Storable.Vector a) -> (Data.Vector.Storable.Vector a)","ident":"deriv","stop":{"line":95,"column":14}},{"start":{"line":95,"column":17},"ann":"(Data.Vector.Storable.Vector a) -> (Data.Vector.Storable.Vector a)","ident":"_","stop":{"line":95,"column":26}},{"start":{"line":95,"column":22},"ann":"a -> a","ident":"act'","stop":{"line":95,"column":26}},{"start":{"line":98,"column":1},"ann":"forall a .\n(GHC.Float.Floating<[]> (Data.Vector.Storable.Vector a), GHC.Float.Floating<[]> a, Internal.Numeric.Numeric<[]> a, Foreign.Storable.Storable<[]> a, GHC.Num.Num<[]> (Data.Vector.Storable.Vector a), Internal.Numeric.Container<[]> Data.Vector.Storable.Vector a) =>\na -> (a -> a) -> (a -> a) -> (Neuro.Network a) -> ((Data.Vector.Storable.Vector a), (Data.Vector.Storable.Vector a)) -> (Neuro.Network a)","ident":"Neuro.updateNetwork","stop":{"line":98,"column":14}},{"start":{"line":98,"column":15},"ann":"a","ident":"alpha","stop":{"line":98,"column":20}},{"start":{"line":98,"column":21},"ann":"a -> a","ident":"act","stop":{"line":98,"column":24}},{"start":{"line":98,"column":25},"ann":"a -> a","ident":"act'","stop":{"line":98,"column":29}},{"start":{"line":98,"column":30},"ann":"(Neuro.Network a)","ident":"n","stop":{"line":98,"column":31}},{"start":{"line":98,"column":72},"ann":"v_B1:(Data.Vector.Vector (Internal.Matrix.Matrix a)) -> {VV : (Neuro.Network a) | VV ~~ v_B1}","ident":"lq_anf$##7205759403792827683","stop":{"line":98,"column":110}},{"start":{"line":98,"column":82},"ann":"(Data.Vector.Vector (Internal.Matrix.Matrix a))","ident":"lq_anf$##7205759403792827686","stop":{"line":98,"column":110}},{"start":{"line":98,"column":93},"ann":"x1:(Internal.Matrix.Matrix a) -> x2:(Internal.Matrix.Matrix a) -> {v : (Internal.Matrix.Matrix a) | v == x1 + x2}","ident":"lq_anf$##7205759403792827684","stop":{"line":98,"column":96}},{"start":{"line":98,"column":106},"ann":"{v : (Data.Vector.Vector (Internal.Matrix.Matrix a)) | 0 <= vlen v}","ident":"lq_anf$##7205759403792827682","stop":{"line":98,"column":110}},{"start":{"line":99,"column":17},"ann":"{v : (Data.Vector.Vector (Data.Vector.Storable.Vector a)) | v == outputs n act input}","ident":"lq_anf$##7205759403792827675","stop":{"line":99,"column":36}},{"start":{"line":99,"column":25},"ann":"{v : (Neuro.Network a) | v == n}","ident":"n","stop":{"line":99,"column":26}},{"start":{"line":99,"column":27},"ann":"a -> a","ident":"act","stop":{"line":99,"column":30}},{"start":{"line":99,"column":31},"ann":"{v : (Data.Vector.Storable.Vector a) | v == input}","ident":"input","stop":{"line":99,"column":36}},{"start":{"line":100,"column":17},"ann":"(Data.Vector.Vector (Internal.Matrix.Matrix a))","ident":"lq_anf$##7205759403792827677","stop":{"line":100,"column":48}},{"start":{"line":100,"column":24},"ann":"{v : (Neuro.Network a) | v == n}","ident":"n","stop":{"line":100,"column":25}},{"start":{"line":100,"column":26},"ann":"a -> a","ident":"act'","stop":{"line":100,"column":30}},{"start":{"line":100,"column":31},"ann":"{v : (Data.Vector.Vector (Data.Vector.Storable.Vector a)) | v == outputs n act input\n                                                            && 0 <= vlen v}","ident":"lq_anf$##7205759403792827676","stop":{"line":100,"column":33}},{"start":{"line":100,"column":34},"ann":"{v : (Data.Vector.Storable.Vector a) | v == expectedOutput}","ident":"expectedOutput","stop":{"line":100,"column":48}},{"start":{"line":101,"column":19},"ann":"(Data.Vector.Vector (Internal.Matrix.Matrix a))","ident":"lq_anf$##7205759403792827681","stop":{"line":101,"column":45}},{"start":{"line":101,"column":26},"ann":"(Internal.Matrix.Matrix a) -> (Internal.Matrix.Matrix a)","ident":"lq_anf$##7205759403792827680","stop":{"line":101,"column":42}},{"start":{"line":101,"column":33},"ann":"{VV : a | VV == (-alpha)\n          && VV == negate alpha}","ident":"lq_anf$##7205759403792827679","stop":{"line":101,"column":41}},{"start":{"line":101,"column":35},"ann":"{VV : a | VV == alpha}","ident":"alpha","stop":{"line":101,"column":40}},{"start":{"line":101,"column":43},"ann":"{v : (Data.Vector.Vector (Internal.Matrix.Matrix a)) | 0 <= vlen v}","ident":"lq_anf$##7205759403792827678","stop":{"line":101,"column":45}},{"start":{"line":109,"column":1},"ann":"forall a .\n(GHC.Float.Floating<[]> (Data.Vector.Storable.Vector a), GHC.Float.Floating<[]> a, Internal.Numeric.Numeric<[]> a, GHC.Num.Num<[]> (Data.Vector.Storable.Vector a), Internal.Numeric.Container<[]> Data.Vector.Storable.Vector a) =>\na -> (a -> a) -> (a -> a) -> (Neuro.Network a) -> [((Data.Vector.Storable.Vector a), (Data.Vector.Storable.Vector a))] -> (Neuro.Network a)","ident":"Neuro.backpropOnce","stop":{"line":109,"column":13}},{"start":{"line":109,"column":14},"ann":"a","ident":"rate","stop":{"line":109,"column":18}},{"start":{"line":109,"column":19},"ann":"a -> a","ident":"act","stop":{"line":109,"column":22}},{"start":{"line":109,"column":23},"ann":"a -> a","ident":"act'","stop":{"line":109,"column":27}},{"start":{"line":109,"column":28},"ann":"(Neuro.Network a)","ident":"n","stop":{"line":109,"column":29}},{"start":{"line":109,"column":30},"ann":"[((Data.Vector.Storable.Vector a), (Data.Vector.Storable.Vector a))]","ident":"samples","stop":{"line":109,"column":37}},{"start":{"line":109,"column":47},"ann":"(Neuro.Network a) -> ((Data.Vector.Storable.Vector a), (Data.Vector.Storable.Vector a)) -> (Neuro.Network a)","ident":"lq_anf$##7205759403792827698","stop":{"line":109,"column":76}},{"start":{"line":109,"column":62},"ann":"{VV : a | VV == rate}","ident":"rate","stop":{"line":109,"column":66}},{"start":{"line":109,"column":67},"ann":"a -> a","ident":"act","stop":{"line":109,"column":70}},{"start":{"line":109,"column":71},"ann":"a -> a","ident":"act'","stop":{"line":109,"column":75}},{"start":{"line":109,"column":77},"ann":"{v : (Neuro.Network a) | v == n}","ident":"n","stop":{"line":109,"column":78}},{"start":{"line":109,"column":79},"ann":"{v : [((Data.Vector.Storable.Vector a), (Data.Vector.Storable.Vector a))] | len v >= 0\n                                                                            && v == samples}","ident":"samples","stop":{"line":109,"column":86}},{"start":{"line":113,"column":1},"ann":"forall a .\n(GHC.Float.Floating<[]> (Data.Vector.Storable.Vector a), GHC.Float.Floating<[]> a, GHC.Real.Fractional<[]> (Internal.Numeric.RealOf a), Internal.Util.Normed<[]> (Data.Vector.Storable.Vector a), Internal.Numeric.Numeric<[]> a) =>\n(a -> a) -> (Neuro.Network a) -> [((Data.Vector.Storable.Vector a), (Data.Vector.Storable.Vector a))] -> (Internal.Numeric.RealOf a)","ident":"Neuro.quadError","stop":{"line":113,"column":10}},{"start":{"line":113,"column":11},"ann":"a -> a","ident":"act","stop":{"line":113,"column":14}},{"start":{"line":113,"column":15},"ann":"(Neuro.Network a)","ident":"net","stop":{"line":113,"column":18}},{"start":{"line":113,"column":19},"ann":"[((Data.Vector.Storable.Vector a), (Data.Vector.Storable.Vector a))]","ident":"samples","stop":{"line":113,"column":26}},{"start":{"line":113,"column":29},"ann":"GHC.Types.Double -> (Internal.Numeric.RealOf a)","ident":"lq_anf$##7205759403792827619","stop":{"line":113,"column":39}},{"start":{"line":113,"column":42},"ann":"GHC.Types.Double","ident":"lq_anf$##7205759403792827627","stop":{"line":113,"column":121}},{"start":{"line":113,"column":49},"ann":"((Data.Vector.Storable.Vector a), (Data.Vector.Storable.Vector a))","ident":"lq_anf$##7205759403792827620","stop":{"line":113,"column":111}},{"start":{"line":113,"column":51},"ann":"GHC.Types.Double","ident":"err","stop":{"line":113,"column":54}},{"start":{"line":113,"column":69},"ann":"{v : GHC.Types.Double | v == err}","ident":"err","stop":{"line":113,"column":72}},{"start":{"line":113,"column":75},"ann":"GHC.Types.Double","ident":"lq_anf$##7205759403792827624","stop":{"line":113,"column":110}},{"start":{"line":113,"column":76},"ann":"(Data.Vector.Storable.Vector a) -> GHC.Types.Double","ident":"lq_anf$##7205759403792827621","stop":{"line":113,"column":82}},{"start":{"line":113,"column":85},"ann":"{v : (Data.Vector.Storable.Vector a) | v == output net act inp}","ident":"lq_anf$##7205759403792827622","stop":{"line":113,"column":103}},{"start":{"line":113,"column":92},"ann":"{v : (Neuro.Network a) | v == net}","ident":"net","stop":{"line":113,"column":95}},{"start":{"line":113,"column":96},"ann":"a -> a","ident":"act","stop":{"line":113,"column":99}},{"start":{"line":113,"column":100},"ann":"{v : (Data.Vector.Storable.Vector a) | v == inp}","ident":"inp","stop":{"line":113,"column":103}},{"start":{"line":113,"column":106},"ann":"{v : (Data.Vector.Storable.Vector a) | v == out}","ident":"out","stop":{"line":113,"column":109}},{"start":{"line":113,"column":112},"ann":"{v : GHC.Types.Double | v == 0.0\n                        && v == D# 0.0}","ident":"lq_anf$##7205759403792827626","stop":{"line":113,"column":113}},{"start":{"line":113,"column":114},"ann":"{v : [((Data.Vector.Storable.Vector a), (Data.Vector.Storable.Vector a))] | len v >= 0\n                                                                            && v == samples}","ident":"samples","stop":{"line":113,"column":121}},{"start":{"line":117,"column":1},"ann":"forall a . (GHC.Float.Floating<[]> a) => a -> a","ident":"Neuro.tanh'","stop":{"line":117,"column":6}},{"start":{"line":117,"column":7},"ann":"a","ident":"x","stop":{"line":117,"column":8}},{"start":{"line":117,"column":15},"ann":"{VV : a | VV == tanh x}","ident":"s","stop":{"line":117,"column":16}},{"start":{"line":117,"column":19},"ann":"{VV : a | VV == tanh x}","ident":"_","stop":{"line":117,"column":25}},{"start":{"line":117,"column":24},"ann":"{VV : a | VV == x}","ident":"x","stop":{"line":117,"column":25}},{"start":{"line":118,"column":15},"ann":"a","ident":"lq_anf$##7205759403792827712","stop":{"line":118,"column":16}},{"start":{"line":118,"column":19},"ann":"{VV : a | VV == tanh x\n          && VV == s}","ident":"s","stop":{"line":118,"column":20}},{"start":{"line":118,"column":22},"ann":"a","ident":"lq_anf$##7205759403792827714","stop":{"line":118,"column":23}},{"start":{"line":121,"column":1},"ann":"forall a .\n(Foreign.Storable.Storable<[]> a, Internal.Matrix.Element<[]> a, Data.Binary.Class.Binary<[]> a) =>\n[GHC.Types.Char] -> (GHC.Types.IO (Neuro.Network a))","ident":"Neuro.loadNetwork","stop":{"line":121,"column":12}},{"start":{"line":121,"column":13},"ann":"[GHC.Types.Char]","ident":"fp","stop":{"line":121,"column":15}},{"start":{"line":121,"column":18},"ann":"{VV : forall a . a -> (GHC.Types.IO a) | VV == return}","ident":"_","stop":{"line":121,"column":24}},{"start":{"line":121,"column":27},"ann":"Data.ByteString.Lazy.Internal.ByteString -> (Neuro.Network a)","ident":"lq_anf$##7205759403792827717","stop":{"line":121,"column":33}},{"start":{"line":121,"column":36},"ann":"Data.ByteString.Lazy.Internal.ByteString -> Data.ByteString.Lazy.Internal.ByteString","ident":"Codec.Compression.Zlib.decompress","stop":{"line":121,"column":46}},{"start":{"line":121,"column":51},"ann":"{v : (GHC.Types.IO Data.ByteString.Lazy.Internal.ByteString) | v == readFile fp}","ident":"lq_anf$##7205759403792827720","stop":{"line":121,"column":65}},{"start":{"line":121,"column":63},"ann":"{v : [GHC.Types.Char] | len v >= 0\n                        && v == fp}","ident":"fp","stop":{"line":121,"column":65}},{"start":{"line":124,"column":1},"ann":"forall a .\n(Foreign.Storable.Storable<[]> a, Internal.Matrix.Element<[]> a, Data.Binary.Class.Binary<[]> a) =>\n[GHC.Types.Char] -> (Neuro.Network a) -> (GHC.Types.IO ())","ident":"Neuro.saveNetwork","stop":{"line":124,"column":12}},{"start":{"line":124,"column":13},"ann":"[GHC.Types.Char]","ident":"fp","stop":{"line":124,"column":15}},{"start":{"line":124,"column":16},"ann":"(Neuro.Network a)","ident":"net","stop":{"line":124,"column":19}},{"start":{"line":124,"column":22},"ann":"Data.ByteString.Lazy.Internal.ByteString -> (GHC.Types.IO ())","ident":"lq_anf$##7205759403792827721","stop":{"line":124,"column":37}},{"start":{"line":124,"column":35},"ann":"{v : [GHC.Types.Char] | len v >= 0\n                        && v == fp}","ident":"fp","stop":{"line":124,"column":37}},{"start":{"line":124,"column":40},"ann":"Data.ByteString.Lazy.Internal.ByteString -> Data.ByteString.Lazy.Internal.ByteString","ident":"Codec.Compression.Zlib.compress","stop":{"line":124,"column":48}},{"start":{"line":124,"column":51},"ann":"{v : Data.ByteString.Lazy.Internal.ByteString | v == encode net}","ident":"lq_anf$##7205759403792827723","stop":{"line":124,"column":61}},{"start":{"line":124,"column":58},"ann":"{v : (Neuro.Network a) | v == net}","ident":"net","stop":{"line":124,"column":61}}],"errors":[]}